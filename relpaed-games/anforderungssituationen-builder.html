<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>Anforderungssituationen – Lernarrangement-Builder</title>
<p><a href="https://github.com/johappel/oer-collections/blob/main/relpaed-games/anforderungssituationen-builder.md">Anleitung</a></p>
<style>
  :root { --c1:#005a9c; --c2:#f3f6fb; --radius:10px; --shadow:0 2px 8px rgba(0,0,0,.15); }
  body { margin:0; font-family:system-ui, sans-serif; background:var(--c2); display:flex; flex-direction:column; align-items:center; padding:2rem; }
  h1 { color:var(--c1); margin-bottom:1rem; }
  #game { max-width:1000px; width:100%; display:grid; grid-template-columns: 2fr 1fr; gap:1.5rem; }
  #challenge { background:#fff; border-radius:var(--radius); padding:1rem; box-shadow:var(--shadow); }
  #challenge h2 { margin-top:0; color:var(--c1); }
  #resources, #arrangement { display:flex; flex-direction:column; gap:.5rem; }
  .card {
    background:#fff; border-radius:var(--radius); padding:.8rem; box-shadow:var(--shadow);
    cursor:pointer; transition:all .2s; user-select:none;
  }
  .card:hover { transform:translateY(-3px); box-shadow:var(--shadow),0 4px 12px rgba(0,0,0,.2); }
  .card.selected { background:#ffd77c; }
  .card h4 { margin:0 0 .3rem 0; font-size:.95rem; }
  .card small { color:#555; }
  #budget { font-weight:bold; color:var(--c1); margin-bottom:.5rem; }
  #score { margin-top:1rem; font-weight:bold; }
</style>
</head>
<body>
<h1>Lernarrangement-Builder</h1>

<div id="game">
  <div>
    <div id="challenge">
      <h2>Aktuelle Anforderungssituation</h2>
      <p id="situationText"></p>
      <ul id="needs"></ul>
    </div>

    <div id="resources">
      <h3>Ressourcen-Karten (Kosten in Klammern)</h3>
    </div>
  </div>

  <div>
    <div id="budget">Budget: 100</div>
    <div id="arrangement">
      <h3>Dein Arrangement (<span id="total">0</span>)</h3>
    </div>
    <button onclick="evaluate()">Auswerten</button>
    <div id="score"></div>
  </div>
</div>

<script>
const situations = [
  {
    title: "Ein Schüler verliert nach dem Tod des Hundes den Glauben an Gott.",
    needs: {empathie:3, theologie:2, bibel:1, ritual:2}
  },
  {
    title: "Die Klasse diskutiert, ob Glaube und Wissenschaft sich widersprechen.",
    needs: {dialog:3, wissenschaft:2, glaube:3, motivation:1}
  },
  {
    title: "Eine Schülerin möchte wissen, warum sie sich als Christin outen soll, wenn das nur Stress bringt.",
    needs: {identitaet:3, courage:2, gesellschaft:2, ethik:1}
  }
];

const cards = [
  {name:"Empathie-Interview", tags:["empathie"], cost:15},
  {name:"Sterbe-Seelsorge-Ritual", tags:["ritual","empathie"], cost:25},
  {name:"Genesis & Big-Bang-Vergleich", tags:["wissenschaft","glaube"], cost:20},
  {name:"Interreligiöser Dialog", tags:["dialog","gesellschaft"], cost:20},
  {name:"Moses-Story als Comic", tags:["bibel","motivation"], cost:15},
  {name:"Identitäts-Workshop", tags:["identitaet","courage"], cost:25},
  {name:"Ethik-Dilemma-Runde", tags:["ethik","dialog"], cost:15},
  {name:"Stille-Übung", tags:["ritual","empathie"], cost:10}
];

let budget = 100;
let selected = [];
let current = situations[Math.floor(Math.random()*situations.length)];

function render() {
  document.getElementById('situationText').textContent = current.title;
  const needs = document.getElementById('needs');
  needs.innerHTML = '';
  Object.entries(current.needs).forEach(([k,v]) => {
    needs.insertAdjacentHTML('beforeend', `<li>${k}: ${v} Punkte benötigt</li>`);
  });

  const resDiv = document.getElementById('resources');
  resDiv.innerHTML = '<h3>Ressourcen-Karten (Kosten in Klammern)</h3>';
  cards.forEach((c,i) => {
    const div = document.createElement('div');
    div.className = 'card';
    div.dataset.index = i;
    div.innerHTML = `<h4>${c.name} (${c.cost})</h4><small>${c.tags.join(', ')}</small>`;
    div.onclick = () => toggle(i);
    resDiv.appendChild(div);
  });
  updateArrangement();
}

function toggle(idx) {
  const card = cards[idx];
  const pos = selected.indexOf(idx);
  if(pos>-1) { selected.splice(pos,1); }
  else if(budget >= card.cost) { selected.push(idx); }
  updateArrangement();
}

function updateArrangement() {
  const arrDiv = document.getElementById('arrangement');
  arrDiv.innerHTML = '<h3>Dein Arrangement (<span id="total">0</span>)</h3>';
  let total = 0;
  selected.forEach(i => {
    const c = cards[i];
    total += c.cost;
    arrDiv.insertAdjacentHTML('beforeend', `<div class="card">${c.name} (${c.cost})</div>`);
  });
  document.getElementById('total').textContent = total;
  budget = 100 - total;
  document.getElementById('budget').textContent = `Budget: ${budget}`;
  document.getElementById('score').textContent = '';
}

function evaluate() {
  const needs = {...current.needs};
  selected.forEach(i => {
    cards[i].tags.forEach(t => {
      if(needs[t]) needs[t]--;
    });
  });
  const missing = Object.values(needs).reduce((a,b)=>a+b,0);
  const totalCost = 100 - budget;
  const efficiency = totalCost > 0 ? Math.round(100*(10-missing)/totalCost) : 0;
  document.getElementById('score').innerHTML = missing ? `Fehlen noch ${missing} Punkte.` : `Perfekt! Effizienz: ${efficiency}%`;
}

render();
</script>
</body>
</html>
